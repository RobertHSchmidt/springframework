<?xml version="1.0"?>
<project name="spring-oxm-maven2-targets" default="generate-test-sources">

    <property name="schema" value="${basedir}/src/test/resources/org/springframework/oxm/flight.xsd"/>
    <property name="generate.target.directory" value="${basedir}/target/generated-sources/test/java"/>

    <target name="generate-test-sources" depends="generate-test-jaxb">
        <copy todir="${basedir}/target/test-classes">
            <fileset dir="${generate.target.directory}">
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
    </target>

    <target name="generate-test-init">
        <mkdir dir="${generate.target.directory}"/>
    </target>

    <target name="generate-test-jaxb" depends="generate-test-init">
        <taskdef name="xjc" classname="com.sun.tools.xjc.XJCTask"
                 classpathref="maven.test.classpath"/>
        <xjc target="${generate.target.directory}"
             package="org.springframework.oxm.jaxb1"
             schema="${schema}">
            <produces dir="${generate.target.directory}" includes="**/*.java"/>
        </xjc>
    </target>

    <target name="test-compile" depends="test-compile-jibx"/>

    <target name="test-compile-jibx">
        <taskdef name="jibx-bind"
                 classname="org.jibx.binding.ant.CompileTask"
                 classpathref="maven.test.classpath"/>
        <jibx-bind load="true"
                   binding="${basedir}/src/test/resources/org/springframework/oxm/jibx/binding.xml">
            <classpathset dir="${basedir}/target/test-classes">
                <include name="**/jibx/**/*"/>
            </classpathset>
        </jibx-bind>
    </target>


</project>